<!DOCTYPE html>
<html lang="en">


<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4Q6Gf2aSP4eDXB8Miphtr37CMZZQ5oXLH2yaXMJ2w8e2ZtHTl7GptT4jmndRuHDT" crossorigin="anonymous">
    <link rel="stylesheet" href="data/style.css">
    <title>FLASHCARDS</title>
</head>


<body>
    <div class="container">
        <div class="row">
            <div class="col-1 avg left"><a id="returnbtn" href="index.html"><</a></div>
            <div class="col-10 big center">ADD NEW</div>
        </div>

        <div class="row">
            <form id="form">
                <div class="form-row ">



                    <div class="form-group col-md-4 mb-0 first-col">
                        <label for="name">NAME</label>
                        <input type="text" class="form-control customborder" id="name" placeholder="">
                        <button id="submitbtn" type="submit" class="btn btn-primary customborder ">Save</button>

                    </div>

                </div>
                <div id="bottomline">

                    <div id="descHolder" class="form-group col-md-6 col-sm-12">
                        <label for="description">Description:</label>
                        <textarea type="text" class="form-control customborder tall" id="description" placeholder=""></textarea>
                    </div>

                    <div class="form-group col-md-6 col-sm-12">
                        <label for="collection">Collectionâ†“</label>
                        <select class="form-control customborder tall" id="collection" size="10">
                        </select>
                    </div>
                </div>

            </form>
        </div>

    </div>




    <script>
        document.addEventListener('DOMContentLoaded', function () {

            const form = document.getElementById('form');
            const nameInput = document.getElementById('name');
            const descriptionInput = document.getElementById('description');
            const collectionSelect = document.getElementById('collection');

            // Load collections when page opens
            loadCollections();

            form.addEventListener('submit', function (e) {
                e.preventDefault();

                const name = nameInput.value.trim();
                const description = descriptionInput.value.trim();
                const selectedCollection = collectionSelect.value;

                if (name === "" || description === "" || selectedCollection === "") {
                    alert("Please fill in all the options!");
                    return;
                }

                fetch('/api/flashcards', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        name: name,
                        description: description,
                        collectionId: parseInt(selectedCollection)
                    })
                })
                    .then(res => {
                        if (!res.ok) {
                            throw new Error("Failed to save flashcard");
                        }
                        return res.json();
                    })
                    .then(() => {
                        alert("Flashcard saved!");
                        form.reset();
                    })
                    .catch(err => alert(err.message));
            });

            // ---------------- FUNCTIONS ----------------

            function loadCollections() {
                fetch('/api/collections')
                    .then(res => res.json())
                    .then(collections => {
                        collectionSelect.innerHTML = ""; // clear old options
                        for (const collection of collections) {
                            addCollectionOption(collection);
                        }
                    })
                    .catch(err => console.error(err));
            }

            function addCollectionOption(col) {
                const option = document.createElement('option');
                option.textContent = col.name;
                option.value = col.id;
                collectionSelect.appendChild(option);
            }
        });
    </script>




</body>



</html >

